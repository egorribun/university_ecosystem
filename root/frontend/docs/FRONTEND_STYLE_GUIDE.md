# Руководство по интерфейсу

## Темизация и токены
- Все цветовые и типографические токены определены в `src/theme.ts` и пробрасываются в DOM через MUI CSS theme variables (префикс `--ue-*`).
- Пользовательские CSS‑переменные (например, `--nav-bg`, `--anim-fast`) синхронизированы с цветовыми схемами и доступны в стилях компонентов.
- Для переключения темы используйте `useColorScheme` из `@mui/material/styles`; ручная работа с `localStorage` и классами `body` больше не требуется.
- Добавление новых токенов происходит в `MuiCssBaseline` — там же можно синхронизировать их с `theme.getCssVar(...)`.

## Светлая/тёмная схемы
- Базовые палитры описаны в `colorSchemes` в `src/theme.ts`.
- Пользователь по умолчанию следует системным настройкам (`defaultMode="system"`). Радиокнопки в настройках вызывают `setMode`.
- При доработках избегайте прямых HEX в компонентах — берите оттенки через `theme.palette.*` либо доступные CSS‑переменные.

## Навигационные паттерны
- Верхнее меню (`Navbar`) и мобильное меню используют одинаковые токены (`--nav-*`).
- Переходы между основными маршрутами анимируются через `PageTransition` (Framer Motion). Для новых разделов подключайте их через `wrap(<Component />)` в `App.tsx`.
- При добавлении навигации соблюдайте правило "скролл к началу" через `markIfFromBottom`/`smoothToTop`.

## Анимации
- Анимации реализованы на базе Framer Motion и CSS переменных с учётом `prefers-reduced-motion`.
- Новые анимации должны либо использовать `useReducedMotion`, либо оборачиваться проверкой `reduceMotion` из контекста.
- Время и кривые переходов берите из `theme.app.transitions` или CSS переменных `--anim-*`.

## Skeleton-состояния
- Для длительных загрузок используйте `@mui/material/Skeleton`. Примеры в `NewsDetail`, `EventDetail`, `Profile`, `NotificationsBell`.
- Skeletonы должны повторять визуальный каркас итогового контента и избегать резких размеров.
- Для кнопок/микроопераций можно оставить встроенный `CircularProgress`.

## PWA и офлайн
- Манифест лежит в `public/manifest.webmanifest`; иконки встроены через data URL, поэтому дополнительных бинарных файлов не требуется. Для пушей и локальных уведомлений используется `public/guu_logo.png`.
- Service Worker собирается Vite PWA (`vite-plugin-pwa`) из `src/pwa/sw.ts` в режиме `injectManifest`. Кэшируются маршруты `/dashboard`, `/news`, `/schedule`, `/events`, `/profile`.
- Для новых offline-ресурсов обновляйте warm cache список и стратегии в `sw.ts`.

## Анализ бандла и code split
- Ручное разделение чанков настроено через `build.rollupOptions.manualChunks` в `vite.config.ts` (отдельные чанки для MUI, анимаций, dayjs и т.д.).
- Запуск анализа: `npm run analyze` — формирует `dist/bundle-stats.html`.

## Документы и дизайн
- Общие стили меню вынесены в `src/assets/themes.css` и используют токены.
- Поддерживайте единый тон типографики: заголовки — `theme.typography.h*`, основной текст — `body1`.

